name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  macos:
    name: macOS (Xcode 16.0, Swift 6.0)
    runs-on: macos-26
    steps:
      - uses: actions/checkout@v6
      - name: Select Xcode 16.0
        run: sudo xcode-select -s /Applications/Xcode_16.0.app
      - name: Swift version
        run: swift --version
      - name: Build
        run: swift build
      - name: Run tests
        run: swift test

  macos-swift-6-2:
    name: macOS (Xcode 16.2, Swift 6.2)
    runs-on: macos-26
    steps:
      - uses: actions/checkout@v6
      - name: Select Xcode 16.2
        run: sudo xcode-select -s /Applications/Xcode_26.0.app
      - name: Swift version
        run: swift --version
      - name: Build
        run: swift build
      - name: Run tests
        run: swift test

  linux:
    name: Linux (Swift 6.0)
    runs-on: ubuntu-latest
    container: swift:6.0
    steps:
      - uses: actions/checkout@v6
      - name: Swift version
        run: swift --version
      - name: Build
        run: swift build
      - name: Run tests
        run: swift test

  windows:
    name: Windows (Swift 6.0)
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v6
      - uses: compnerd/gha-setup-swift@main
        with:
          branch: swift-6.0-release
          tag: 6.0-RELEASE
      - name: Swift version
        run: swift --version
      - name: Build
        run: swift build
      - name: Run tests
        run: swift test
